<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns:th="http://www.w3.org/1999/xhtml"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5"
	layout:decorator="~{layouts/panel/layout.html}">
<head>
<meta charset="UTF-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<title>Purchase Analysis</title>

<style type="text/css">/* Chart.js */
@
-webkit-keyframes chartjs-render-animation {
	from {opacity: 0.99
}

to {
	opacity: 1
}

}
@
keyframes chartjs-render-animation {
	from {opacity: 0.99
}

to {
	opacity: 1
}

}
.chartjs-render-monitor {
	-webkit-animation: chartjs-render-animation 0.001s;
	animation: chartjs-render-animation 0.001s;
}
</style>
</head>


<body class="fixed-sn white-skin" id="body">

	<div layout:fragment="content">




		<main>
			<div class="container-fluid">

				<!-- Section: Basic examples -->
				<section>

					<div id="contectChangeArea">



						<section class="mt-md-4 pt-md-2 mb-5 pb-4">

							<!-- Grid row -->
							<div class="row">

								<!-- Grid column -->
								<div class="col-xl-3 col-md-6 mb-xl-0 mb-4">

									<!-- Card -->
									<div class="card card-cascade cascading-admin-card">

										<!-- Card Data -->
										<div class="admin-up">
											<i class="far fa-money-bill-alt primary-color mr-3 z-depth-2"></i>
											<div class="data">
												<p class="text-uppercase">All orders</p>
												<h4 class="font-weight-bold dark-grey-text">#DP132</h4>
											</div>
										</div>

										<!-- Card content -->
										<div class="card-body card-body-cascade">
											<div class="progress mb-3">
												<div class="progress-bar bg-primary" role="progressbar"
													aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"
													style="width: 100%"></div>
											</div>
											<p class="card-text">counts all orders cancelled to
												completed</p>
										</div>

									</div>
									<!-- Card -->

								</div>
								<!-- Grid column -->

								<!-- Grid column -->
								<div class="col-xl-3 col-md-6 mb-xl-0 mb-4">

									<!-- Card -->
									<div class="card card-cascade cascading-admin-card">

										<!-- Card Data -->
										<div class="admin-up">
											<i class="fas fa-chart-line warning-color mr-3 z-depth-2"></i>
											<div class="data">
												<p class="text-uppercase">Completed Orders</p>
												<h4 class="font-weight-bold dark-grey-text">#DP231</h4>
											</div>
										</div>

										<!-- Card content -->
										<div class="card-body card-body-cascade">
											<div class="progress mb-3">
												<div class="progress-bar red accent-2" role="progressbar"
													aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"
													style="width: 100%"></div>
											</div>
											<p class="card-text">Dynamic Graphs by year based on the
												completed orders</p>
										</div>

									</div>
									<!-- Card -->

								</div>
								<!-- Grid column -->

								<!-- Grid column -->
								<div class="col-xl-3 col-md-6 mb-md-0 mb-4">

									<!-- Card -->
									<div class="card card-cascade cascading-admin-card">

										<!-- Card Data -->
										<div class="admin-up">
											<i
												class="fas fa-chart-pie light-blue lighten-1 mr-3 z-depth-2"></i>
											<div class="data">
												<p class="text-uppercase">Cancelled Orders</p>
												<h4 class="font-weight-bold dark-grey-text">#DP1212</h4>
											</div>
										</div>

										<!-- Card content -->
										<div class="card-body card-body-cascade">
											<div class="progress mb-3">
												<div class="progress-bar red accent-2" role="progressbar"
													aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"
													style="width: 100%"></div>
											</div>
											<p class="card-text">Find out the modes in which the
												orders was cancelled</p>
										</div>

									</div>
									<!-- Card -->

								</div>
								<!-- Grid column -->

								<!-- Grid column -->
								<div class="col-xl-3 col-md-6 mb-0">

									<!-- Card -->
									<div class="card card-cascade cascading-admin-card">

										<!-- Card Data -->
										<div class="admin-up">
											<i class="fas fa-chart-bar red accent-2 mr-3 z-depth-2"></i>
											<div class="data">
												<p class="text-uppercase">COD Orders</p>
												<h4 class="font-weight-bold dark-grey-text">#TUF131</h4>
											</div>
										</div>

										<!-- Card content -->
										<div class="card-body card-body-cascade">
											<div class="progress mb-3">
												<div class="progress-bar bg-primary" role="progressbar"
													aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"
													style="width: 100%"></div>
											</div>
											<p class="card-text">Get the orders completed with cash
												on delivery</p>
										</div>

									</div>
									<!-- Card -->

								</div>
								<!-- Grid column -->

							</div>
							<!-- Grid row -->

						</section>





						<!-- chart 1-->
						<!-- Section: Chart -->
						<section class="mb-5 mt-5">

							<!-- Card -->
							<div class="card card-cascade narrower">
								<section>

									<!-- Grid row -->
									<div class="row">

										<!-- Grid column -->
										<div class="col-xl-5 col-lg-12 mr-0 pb-2">

											<!-- Card image -->
											<div
												class="view view-cascade gradient-card-header light-blue lighten-1">
												<h2 class="h2-responsive mb-0 font-weight-500">Sales
													per year</h2>
											</div>

											<!-- Card content -->
											<div class="card-body card-body-cascade pb-0">

												<!-- Panel data -->
												<div class="row py-3 pl-4">

													<!-- First column -->
													<div class="col-md-6">

														<!-- Date select -->
														<p class="lead">
															<span class="badge info-color p-2" id="dataRange">Current
																year sales</span>
														</p>


														<!-- Date pickers -->
														<p class="lead pt-3 pb-4">
															<span class="badge info-color p-2">Select Custom
																Year</span>
														</p>
														<div class="md-form">
															<input placeholder="Select year" type="text" id="toYear"
																class="form-control yearonlyDatePicker"> <label
																for="date-picker-example"></label>
														</div>
													</div>
													<!-- First column -->

													<!-- Second column -->
													<div class="col-md-6 text-center pl-xl-2 my-md-0 my-3">

														<!-- Summary -->
														<p>
															Total Sales: <strong><span
																id="totalValueOfOrders"></span></strong>
														</p>
														<p>
															No. of Orders: <strong><span id="totalNoOrders"></span></strong>
														</p>

														<!-- Change chart -->
														<span class="min-chart my-4" id="chart-sales"
															data-percent="99"><span class="percent"></span></span>
														<h5>
															<a class="badge green p-2"
																onclick="orderChartManagement()">Generate <i
																class="fas fa-arrow-circle-up ml-1"></i></a>
															<button type="button" class="btn btn-info btn-sm p-2"
																data-toggle="tooltip" data-placement="top"
																title="Percentage is the acuracy of the data displayed">
																<i class="fas fa-question"></i>
															</button>
														</h5>

													</div>
													<!-- Second column -->

												</div>
												<!-- Panel data -->

											</div>
											<!-- Card content -->

										</div>
										<!-- Grid column -->

										<!-- Grid column -->
										<div class="col-xl-7 col-lg-12 mb-4 pb-2">

											<!-- Chart -->
											<div
												class="view view-cascade gradient-card-header blue-gradient">

												<canvas id="lineChart" height="175"></canvas>

											</div>

										</div>
										<!-- Grid column -->

									</div>
									<!-- Grid row -->

								</section>
							</div>
						</section>
						<!-- Section: Chart -->
						<!-- chart 1-->



						<!-- chart 2-->
						<!-- Heading & Date -->
						<div class="container-fluid mt-5">

							<div class="row mb-5 mt-lg-5">

								<!-- First column -->
								<div class="col-md-6 panel-title mb-5 mt-3">
									<h5>
										<span
											class="px-4 py-3 white-text z-depth-1-half blue lighten-1"
											style="border-radius: 5px;">Orders Completed vs
											Cancelled </span>
									</h5>
								</div>
								<!-- First column -->

								<!-- Second column -->
								<div class="col-md-6">

									<div class="card">

										<div class="card-body pb-1">

											<!-- Grid row -->
											<div class="container">

												<!-- Grid column -->

												<div class="md-form">
													<input placeholder="Select year" type="text"
														onchange="orderChartManagement2()" id="toYear2"
														class="form-control yearonlyDatePicker"> <label
														for="date-picker-example"></label>
												</div>

												<!-- Grid column -->
											</div>
											<!-- Grid column -->

										</div>
										<!-- Grid column -->

									</div>
									<!-- Grid row -->

								</div>

							</div>
							<!-- Second column -->

						</div>
						<!-- Heading & Date -->

						<!-- Section: Main chart -->
						<section>

							<!-- Card -->
							<div class="card card-cascade narrower">

								<!-- Card image -->
								<div
									class="view view-cascade gradient-card-header blue-gradient">
									<canvas id="sales"></canvas>
								</div>
								<!-- Card image -->

								<!-- Card content -->
								<div class="card-body card-body-cascade blue-panel text-center">

									<!-- Second row -->
									<div class="row mx-3 mb-0 text-center">
										<!-- Grid column -->
										<div class="col mt-1 mb-2">

											<div class="btn-group mt-1" data-toggle="buttons">

												<label class="btn btn-info btn-md active"> <input
													type="checkbox" name="options" id="option1"
													autocomplete="off" checked>Total completed Sales <strong><span
														id="totalCSales">Rs.1000</span></strong> <i
													class="fas fa-arrow-up ml-2 white-text"></i> <strong>
												</strong>

												</label>

											</div>

											<div class="btn-group mt-1" data-toggle="buttons">

												<label class="btn btn-info btn-md"> <input
													type="checkbox" name="options" id="option2"
													autocomplete="off">Total completed Orders <strong><span
														id="totalCorders">1000</span></strong> <i
													class="fas fa-arrow-up ml-2 white-text"></i> <strong>
												</strong>

												</label>

											</div>



										</div>
										<!-- Grid column -->

									</div>
									<!-- Second row -->

									<!-- Third row -->
									<div class="row mx-3 mb-2 text-center">

										<!-- First column -->
										<div class="col">


											<div class="btn-group mt-1" data-toggle="buttons">

												<label class="btn red accent-2 btn-md text-white"> <input
													type="checkbox" name="options" id="option2"
													autocomplete="off">Total cancelled Sales <strong><span
														id="totalCancellSales">Rs.1000</span></strong> <i
													class="fas fa-arrow-down ml-2 white-text"></i> <strong>
												</strong>

												</label>

											</div>

											<div class="btn-group mt-1" data-toggle="buttons">

												<label class="btn red accent-2 btn-md text-white"> <input
													type="checkbox" name="options" id="option2"
													autocomplete="off">Total cancelled Orders <strong><span
														id="totalCancellorders">1000</span></strong> <i
													class="fas fa-arrow-down ml-2 white-text"></i> <strong>
												</strong>

												</label>

											</div>

										</div>
										<!-- Second column -->

									</div>



									<div class="row mx-3 mb-5 text-center">

										<!-- First column -->
										<div class="col">




											<div class="btn-group mt-1" data-toggle="buttons">

												<label class="btn btn-primary btn-md"> <input
													type="radio" name="options" id="option1" autocomplete="off"
													checked>Months

												</label>

											</div>

											<div class="btn-group mt-1" data-toggle="buttons">

												<label class="btn btn-primary btn-md"> <input
													type="radio" name="options" id="option2" autocomplete="off">Years

												</label>

											</div>

											<div class="btn-group mt-1" data-toggle="buttons">

												<label class="btn btn-primary btn-md"> <input
													type="radio" name="options" id="option3" autocomplete="off">Sales

												</label>

											</div>

											<div class="btn-group mt-1" data-toggle="buttons">

												<label class="btn btn-primary btn-md"> <input
													type="radio" name="options" id="option4" autocomplete="off">Orders
												</label>

											</div>

											<div class="btn-group mt-1" data-toggle="buttons">

												<label class="btn btn-primary btn-md"> <input
													type="radio" name="options" id="option4" autocomplete="off">Completed
												</label>

											</div>
											<div class="btn-group mt-1" data-toggle="buttons">

												<label class="btn btn-primary btn-md"> <input
													type="radio" name="options" id="option4" autocomplete="off">Cancelled
												</label>

											</div>


										</div>
										<!-- Second column -->

									</div>
									<!-- Third row -->

									<!-- Third row -->
									<div class="row mb-0">

										<!-- First column -->
										<div class="col-md-12">

											<!-- Panel content -->
											<div class="card-body pt-0">

												<!-- Table -->
												<div class="table-responsive">

													<table class="table table-hover">

														<!-- Table head -->
														<thead class="rgba-stylish-strong white-text">

															<tr>
																<th></th>
																<th>January</th>
																<th>February</th>
																<th>March</th>
																<th>April</th>
																<th>May</th>
																<th>June</th>
																<th>July</th>
																<th>August</th>
																<th>September</th>
																<th>October</th>
																<th>November</th>
																<th>December</th>
															</tr>

														</thead>
														<!-- Table head -->

														<!-- Table body -->
														<tbody id="ordwersColumns">

														</tbody>
														<!-- Table body -->
													</table>

												</div>
												<!-- Table -->

												<!-- Bottom Table UI -->
												<div class="d-flex justify-content-between">

													<!-- Name -->

												</div>
												<!-- Bottom Table UI -->

											</div>
											<!-- Panel content -->

										</div>
										<!-- First column -->
									</div>
									<!-- Third row -->

								</div>
								<!-- Card content -->

							</div>
							<!-- Card -->

						</section>
						<!-- Section: Main chart -->

						<!-- chart 2-->






						<script>
							orderChartManagement();
							orderChartManagement2();

							function orderChartManagement() {

								$("#toYear").datepicker({
									format : "yyyy",
									viewMode : "years",
									minViewMode : "years"
								});

								var dataByServlet = null;

								$(function() {
									$('.min-chart#chart-sales')
											.easyPieChart(
													{
														barColor : "#FF5252",
														onStep : function(from,
																to, percent) {
															$(this.el)
																	.find(
																			'.percent')
																	.text(
																			Math
																					.round(percent));
														}
													});
								});

								var dataYear = $('#toYear').val();

								if (dataYear != '')
									$('#dataRange').text(dataYear);

								$
										.ajax({

											url : "/panel/charts/ordersPerYear",
											data : {
												'year' : dataYear
											},
											success : function(dataSent) {

												var dataResponse = $
														.parseJSON(dataSent);
												var data1 = dataResponse[0];
												var data2 = dataResponse[1];
												var data3 = dataResponse[2];

												var ordersCompleted = dataResponse[3];
												var TotalsalesCompleted = dataResponse[4];
												var totalCompleted = dataResponse[5];

												var ordersCancelled = dataResponse[6];
												var TotalsalesCancelled = dataResponse[7];
												var totalCancelled = dataResponse[8];

												$('#totalValueOfOrders')
														.text(
																"Rs."
																		+ TotalsalesCompleted);
												$('#totalNoOrders').text(
														totalCompleted);

												dataByServlet = ordersCompleted;

												var ctxL = document
														.getElementById(
																"lineChart")
														.getContext('2d');
												var myLineChart = new Chart(
														ctxL,
														{
															type : 'line',
															data : {
																labels : [
																		"January",
																		"February",
																		"March",
																		"April",
																		"May",
																		"June",
																		"July",
																		"August",
																		"September",
																		"Octomber",
																		"November",
																		"December" ],
																datasets : [ {
																	label : "Sales per year based on month",
																	fillColor : "#fff",
																	backgroundColor : 'rgba(255, 255, 255, .3)',
																	borderColor : 'rgba(255, 255, 255)',
																	data : dataByServlet,
																} ]
															},
															options : {
																legend : {
																	labels : {
																		fontColor : "#fff",
																	}
																},
																scales : {
																	xAxes : [ {
																		gridLines : {
																			display : true,
																			color : "rgba(255,255,255,.25)"
																		},
																		ticks : {
																			fontColor : "#fff",
																		},
																	} ],
																	yAxes : [ {
																		display : true,
																		gridLines : {
																			display : true,
																			color : "rgba(255,255,255,.25)"
																		},
																		ticks : {
																			fontColor : "#fff",
																		},
																	} ],
																}
															}
														});

											}

										});

							};

							function orderChartManagement2() {

								$("#toYear2").datepicker({
									format : "yyyy",
									viewMode : "years",
									minViewMode : "years"
								});

								var dataYear = $('#toYear2').val();

								$
										.ajax({

											url : "/panel/charts/ordersPerYear",
											data : {
												'year' : dataYear
											},
											success : function(dataSent) {

												var dataResponse = $
														.parseJSON(dataSent);

												var data1 = dataResponse[0];
												var data2 = dataResponse[1];
												var data3 = dataResponse[2];

												var ordersCompleted = dataResponse[3];
												var TotalsalesCompleted = dataResponse[4];
												var totalCompleted = dataResponse[5];

												var ordersCancelled = dataResponse[6];
												var TotalsalesCancelled = dataResponse[7];
												var totalCancelled = dataResponse[8];

												console.log(totalCancelled
														+ "dsdsdsdsd");

												Chart.defaults.global.defaultFontColor = '#fff';

												// line
												var ctxL = document
														.getElementById("sales")
														.getContext('2d');
												var myLineChart = new Chart(
														ctxL,
														{
															type : 'line',
															data : {
																labels : [
																		"January",
																		"February",
																		"March",
																		"April",
																		"May",
																		"June",
																		"July",
																		"August",
																		"September",
																		"Octomber",
																		"November",
																		"December" ],
																datasets : [
																		{
																			label : "Orders Completed",
																			strokeColor : "rgba(220,220,220,1)",
																			pointColor : "rgba(220,220,220,1)",
																			pointStrokeColor : "#fff",
																			pointHighlightFill : "#fff",
																			pointHighlightStroke : "rgba(220,220,220,1)",
																			fillColor : "#fff",
																			backgroundColor : 'rgba(255, 255, 255, .3)',
																			borderColor : 'rgba(255, 255, 255)',
																			borderWidth : 1,
																			data : ordersCompleted,
																		},
																		{
																			label : "Orders Cancelled",
																			strokeColor : "rgba(151,187,205,1)",
																			pointColor : "rgba(151,187,205,1)",
																			pointStrokeColor : "#fff",
																			pointHighlightFill : "#fff",
																			pointHighlightStroke : "rgba(151,187,205,1)",
																			fillColor : "#fff",
																			backgroundColor : 'rgba(255, 255, 255, .3)',
																			borderColor : 'rgba(255, 255, 255)',
																			borderWidth : 1,
																			data : ordersCancelled,
																		} ]
															},
															options : {
																responsive : true
															}
														});

												var s = '<tbody id="ordwersColumns" >'
														+ '<tr class="none-top-border" id="ordwersCompletedColumn" ><td>Orders Completed</td>';

												for (var i = 0; i < ordersCompleted.length; i++) {

													s += '<td>'
															+ ordersCompleted[i]
															+ '</td>';

												}
												;

												s += '</tr><tr id="ordwersCancelledColumn" ><td>Orders Cancelled</td>';

												for (var i = 0; i < ordersCancelled.length; i++) {

													s += '<td>'
															+ ordersCancelled[i]
															+ '</td>';

												}
												;

												s += '</tr></tbody>';

												document
														.getElementById('ordwersColumns').innerHTML = s;

												$('#totalCSales')
														.text(
																" Rs."
																		+ TotalsalesCompleted);
												$('#totalCorders').text(
														" " + totalCompleted);
												$('#totalCancellSales')
														.text(
																" Rs."
																		+ TotalsalesCancelled);
												$('#totalCancellorders').text(
														" " + totalCancelled);

											}

										});

							};
						</script>





					</div>
				</section>
			</div>

		</main>








	</div>

</body>
</html>